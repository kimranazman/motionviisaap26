# Milestone v2.1: Navigation & Views

**Status:** SHIPPED 2026-01-28
**Phases:** 54-56
**Total Plans:** 5

## Overview

v2.1 consolidates the sidebar navigation into collapsible groups with shared config (fixing existing mobile drift), adds a cross-project task page with table and kanban views, and delivers per-member workload dashboards. Three phases execute sequentially: navigation unification unblocks the new page links, the task page establishes cross-entity query patterns, and member workload reuses those patterns for multi-model aggregation.

## Phases

### Phase 54: Collapsible Sidebar Navigation

**Goal**: User navigates a clean, organized sidebar where SAAP, CRM, and Admin items are in collapsible groups, and Tasks/Members are accessible as top-level links
**Depends on**: Nothing (first phase of v2.1)
**Plans**: 1 plan

Plans:
- [x] 54-01: Unified navigation config, collapse state hook, NavGroup component, and sidebar refactor (NAV-01 through NAV-11)

**Details:**
- Single source of truth nav-config.ts with typed NavItem, NavGroup, TopLevelNavItem, findGroupForPath
- SSR-safe useNavCollapseState hook with localStorage persistence and auto-expand for active route
- Reusable NavGroupComponent with Radix Collapsible, chevron rotation animation, item count badge
- Desktop and mobile sidebars refactored to consume shared config (mobile now includes Price Comparison)
- Top-level Tasks (/tasks) and Members (/members) links added to both sidebars

### Phase 55: Cross-Project Task View

**Goal**: User can view, filter, sort, and manage all tasks across all projects from a single /tasks page with table and kanban views
**Depends on**: Phase 54 (nav link to /tasks)
**Plans**: 2 plans

Plans:
- [x] 55-01: Server page, filter bar, table view with sortable columns, detail sheet, view preference (TASK-01, 02, 04-12, 14, 15)
- [x] 55-02: Kanban view with dnd-kit drag-and-drop status changes (TASK-03, 04, 13)

**Details:**
- Server component fetching all root tasks with project context
- 6-filter client shell: search, assignee, project, status, priority, due date range
- Sortable table with 6 columns, overdue highlighting, subtask/comment indicators
- dnd-kit kanban board with 3 status columns, drag-and-drop status changes
- Mobile touch support with tap detection, 250ms delay, horizontal scroll snap
- View preference persisted in localStorage

### Phase 56: Member Workload Dashboard

**Goal**: User can see each team member's workload across all entity types (KRs, initiatives, tasks, support tasks) from overview and detail pages
**Depends on**: Phase 55 (task query patterns and components)
**Plans**: 2 plans

Plans:
- [x] 56-01: Member utils, overview page with 3 member cards and aggregated counts (MBR-01, MBR-02, MBR-03)
- [x] 56-02: Detail page with stats header, 5 sections (KRs, Initiatives, Accountable, Tasks, Support Tasks), and red highlighting (MBR-04 through MBR-11)

**Details:**
- member-utils.ts with 3 member profiles, lookup functions, overdue/at-risk helpers, status breakdown
- /members overview page with parallel Promise.all querying 4 models, aggregated counts per member
- /members/[name] detail page with parallel Prisma queries for 5 data sets
- Summary stats header with total counts per entity type and status breakdowns
- 5 sections: Key Results (progress bars), Initiatives (personInCharge), Accountable For (distinct), Tasks (cross-project), Support Tasks (category borders)
- Red highlighting for overdue, AT_RISK, and HIGH priority items

---

## Milestone Summary

**Key Decisions:**
- localStorage for sidebar collapse state (device-specific, no cross-device sync needed)
- All nav groups default expanded on first visit for discoverability
- Server component Prisma fetch (no API route) for tasks page data
- router.refresh() for data refresh after detail sheet saves
- Project-scoped PATCH API for drag status changes in kanban
- Optimistic update on dragOver for immediate visual feedback
- 3 hardcoded member profiles in member-utils.ts (matches existing team enum)

**Issues Resolved:**
- Mobile sidebar missing Price Comparison link (CRM drift fixed by shared nav config)
- TaskDetailSheet parentId compatibility for cross-project tasks

**Issues Deferred:**
None.

**Technical Debt Incurred:**
None.

---

_For current project status, see .planning/ROADMAP.md_
