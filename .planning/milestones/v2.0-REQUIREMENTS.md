# Requirements Archive: v2.0 OKR Restructure & Support Tasks

**Archived:** 2026-01-27
**Status:** SHIPPED

This is the archived requirements specification for v2.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## Overview

Promote KeyResult from a free-text string to a first-class tracked entity, add support task management with KR linkage, reseed from updated Excel, and add revenue target dashboard widget.

**Source:** MotionVii_SAAP_2026_v2.xlsx (6 KRs, 37 initiatives, 30 support tasks)

---

## SCHEMA: Data Model Changes

- [x] SCHEMA-01: KeyResult Model -- KeyResult as first-class Prisma model with krId, objective, description, metricType, target, actual, unit, progress, deadline, status, owner, howWeMeasure, notes, weight
- [x] SCHEMA-02: MetricType Enum -- REVENUE and COUNT values
- [x] SCHEMA-03: KeyResultStatus Enum -- NOT_STARTED, ON_TRACK, AT_RISK, BEHIND, ACHIEVED
- [x] SCHEMA-04: Initiative FK to KeyResult -- keyResultId FK replacing keyResult string; budget, resources fields added
- [x] SCHEMA-05: Remove Initiative KPI Fields -- kpiTarget, kpiActual, kpiUnit, kpiAutoCalculated, monthlyObjective, weeklyTasks removed
- [x] SCHEMA-06: SupportTask Model -- taskId, category, task, owner, frequency, priority, notes with many-to-many KR relation
- [x] SCHEMA-07: SupportTaskCategory Enum -- DESIGN_CREATIVE, BUSINESS_ADMIN, TALENTA_IDEAS, OPERATIONS
- [x] SCHEMA-08: SupportTaskKeyResult Join Table -- Explicit join with composite unique constraint

---

## SEED: Data Migration

- [x] SEED-01: Wipe Existing Data -- FK_CHECKS=0 clean slate wipe preserving non-OKR data
- [x] SEED-02: Parse Key Results Sheet -- 6 KeyResult records from Excel
- [x] SEED-03: Parse Initiatives Sheet -- 37 Initiative records with KeyResult FK linkage
- [x] SEED-04: Parse Support Tasks Sheet -- 30 SupportTask records with 59 join table entries
- [x] SEED-05: Parse Events Sheet -- Events data from Excel
- [x] SEED-06: Seed Validation Summary -- Record counts and parsing warnings

---

## API: Endpoints

- [x] API-01: KeyResult CRUD -- GET list, GET detail, PATCH update
- [x] API-02: SupportTask Read -- GET list with category filter
- [x] API-03: Updated Initiative Endpoints -- keyResultId FK, budget/resources, no KPI fields
- [x] API-04: Updated Dashboard Stats -- Revenue from KeyResult actual values

---

## UTIL: Utility Updates

- [x] UTIL-01: Grouping Utilities -- Group by KeyResult relation instead of string
- [x] UTIL-02: Remove KPI Utilities -- initiative-kpi-utils.ts stubbed then deleted
- [x] UTIL-03: KR Progress Calculation -- Weighted objective rollup from KR weights

---

## UI-OKR: OKR Hierarchy UI Updates

- [x] UI-OKR-01: KR Row Metrics Display -- description, target, actual, progress bar, unit, status, owner, deadline
- [x] UI-OKR-02: Objective Rollup Progress -- Weighted rollup from child KR weights and progress
- [x] UI-OKR-03: Simplified Initiative Rows -- No KPI progress bars; show title, department, PIC, status, dates, budget
- [x] UI-OKR-04: Update Initiative Forms -- KR select dropdown, budget/resources fields, no KPI fields
- [x] UI-OKR-05: Update Initiative Detail -- Linked KR info, budget, resources, accountable; no KPI section
- [x] UI-OKR-06: Update 22-File References -- All keyResult string references migrated to FK relation
- [x] UI-OKR-07: Update 8-File KPI References -- All KPI field references updated or cleaned

---

## UI-ST: Support Tasks Page

- [x] UI-ST-01: Support Tasks Page -- /support-tasks with 4-category grouping
- [x] UI-ST-02: Category Filtering -- Filter by category with "all" default
- [x] UI-ST-03: Navigation Entry -- Sidebar entry under OKR section
- [x] UI-ST-04: KR Badge Links -- Clickable KR badges linking to objectives view

---

## UI-REV: Revenue Target Widget

- [x] UI-REV-01: Revenue Target Widget -- RM1M total with Events RM800K + AI Training RM200K breakdown
- [x] UI-REV-02: Widget Registration -- Registered in widget registry with EDITOR role restriction

---

## CLEAN: Cleanup

- [x] CLEAN-01: Remove Dead Code -- initiative-kpi-utils.ts and kpi-progress-bar.tsx deleted; deprecated fields removed
- [x] CLEAN-02: Update Export -- KR description column, budget/resources/accountable added, KPI columns removed
- [x] CLEAN-03: Verify File Migration -- All 22 Appendix A + 8 Appendix B files verified migrated

---

## TIMELINE: Timeline Enhancements

- [x] TIMELINE-01: Drag-to-Edit Dates -- Center drag shifts both dates; edge drag resizes; persists via API; canEdit gated
- [x] TIMELINE-02: Full Initiative Titles -- No truncation in timeline sidebar
- [x] TIMELINE-03: Objective Grouping Default -- Objective > KeyResult sub-headers; department alternative available

---

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| SCHEMA-01 | Phase 46 | Complete |
| SCHEMA-02 | Phase 46 | Complete |
| SCHEMA-03 | Phase 46 | Complete |
| SCHEMA-04 | Phase 46 | Complete |
| SCHEMA-05 | Phase 46 | Complete |
| SCHEMA-06 | Phase 46 | Complete |
| SCHEMA-07 | Phase 46 | Complete |
| SCHEMA-08 | Phase 46 | Complete |
| SEED-01 | Phase 47 | Complete |
| SEED-02 | Phase 47 | Complete |
| SEED-03 | Phase 47 | Complete |
| SEED-04 | Phase 47 | Complete |
| SEED-05 | Phase 47 | Complete |
| SEED-06 | Phase 47 | Complete |
| API-01 | Phase 48 | Complete |
| API-02 | Phase 48 | Complete |
| API-03 | Phase 48 | Complete |
| API-04 | Phase 48 | Complete |
| UTIL-01 | Phase 48 | Complete |
| UTIL-02 | Phase 48 | Complete |
| UTIL-03 | Phase 48 | Complete |
| UI-OKR-01 | Phase 49 | Complete |
| UI-OKR-02 | Phase 49 | Complete |
| UI-OKR-03 | Phase 49 | Complete |
| UI-OKR-04 | Phase 49 | Complete |
| UI-OKR-05 | Phase 49 | Complete |
| UI-OKR-06 | Phase 49 | Complete |
| UI-OKR-07 | Phase 49 | Complete |
| UI-ST-01 | Phase 50 | Complete |
| UI-ST-02 | Phase 50 | Complete |
| UI-ST-03 | Phase 50 | Complete |
| UI-ST-04 | Phase 50 | Complete |
| UI-REV-01 | Phase 51 | Complete |
| UI-REV-02 | Phase 51 | Complete |
| CLEAN-01 | Phase 52 | Complete |
| CLEAN-02 | Phase 52 | Complete |
| CLEAN-03 | Phase 52 | Complete |
| TIMELINE-01 | Phase 53 | Complete |
| TIMELINE-02 | Phase 53 | Complete |
| TIMELINE-03 | Phase 53 | Complete |

---

## Milestone Summary

**Shipped:** 40 of 40 requirements
**Adjusted:** None -- all requirements delivered as specified
**Dropped:** None

---
*Archived: 2026-01-27 as part of v2.0 milestone completion*
