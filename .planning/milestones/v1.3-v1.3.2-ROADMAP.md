# Milestone v1.3.x: Document Management, Dashboard Customization, Revenue Model & Conversion Visibility

**Status:** SHIPPED 2026-01-24
**Phases:** 21-28
**Total Plans:** 25

## Overview

This combined archive covers the v1.3 series milestones:
- **v1.3** Document Management & Dashboard Customization (Phases 21-25)
- **v1.3.1** Revenue Model Refinement (Phase 26)
- **v1.3.2** Conversion Visibility & Archive (Phases 27-28)

Individual milestone archives exist for v1.3.2-ROADMAP.md and v1.3.2-REQUIREMENTS.md.

## Milestones

- [x] **v1.3 MVP** — Phases 21-25 (shipped 2026-01-24)
- [x] **v1.3.1 Security** — Phase 26 (shipped 2026-01-24)
- [x] **v1.3.2 Conversion Visibility & Archive** — Phases 27-28 (shipped 2026-01-24)

## Phases

### Phase 21: Infrastructure & Schema
**Goal**: Foundation is configured and ready for document and dashboard features
**Depends on**: Phase 20 (v1.2.1 complete)
**Requirements**: INFRA-01, INFRA-02, INFRA-03, INFRA-04
**Plans**: 2 plans

Plans:
- [x] 21-01-PLAN.md — Infrastructure config (Next.js body size, Docker volume mount)
- [x] 21-02-PLAN.md — Schema & file serving (Prisma models, file API route, types)

### Phase 22: Document Management
**Goal**: Users can upload, view, and manage documents attached to projects
**Depends on**: Phase 21
**Requirements**: DOC-01 through DOC-17
**Plans**: 3 plans

Plans:
- [x] 22-01-PLAN.md — API routes & schema (document CRUD endpoints, project date fields, utils)
- [x] 22-02-PLAN.md — Upload & display components (react-dropzone, upload zone, document card/list, preview)
- [x] 22-03-PLAN.md — Integration (Documents section in ProjectDetailSheet, date pickers)

### Phase 23: Widget Registry & Roles
**Goal**: Widget system foundation with role-based access control for dashboard
**Depends on**: Phase 21 (UserPreferences, AdminDefaults models)
**Requirements**: DASH-09, DASH-10, DASH-11
**Plans**: 3 plans

Plans:
- [x] 23-01-PLAN.md — Widget registry & types (WidgetDefinition, WIDGET_REGISTRY with 7 widgets)
- [x] 23-02-PLAN.md — Permission & defaults utilities (canViewWidget, filterWidgetsByRole, getAdminDefaults)
- [x] 23-03-PLAN.md — Admin API & dashboard filtering (layout/roles endpoints, server-side widget filtering)

### Phase 24: Dashboard Customization UI
**Goal**: Users can customize their dashboard layout with drag-drop, resize, and persistence
**Depends on**: Phase 23 (widget registry and role system)
**Requirements**: DASH-01 through DASH-08, DASH-12 through DASH-15
**Plans**: 5 plans

Plans:
- [x] 24-01-PLAN.md — Dependencies and infrastructure (react-grid-layout, sonner, user preferences API, layout utils)
- [x] 24-02-PLAN.md — Date range filter (date utilities, DateRangeFilter component with presets)
- [x] 24-03-PLAN.md — Dashboard grid (react-grid-layout grid, widget wrapper, layout hook with undo)
- [x] 24-04-PLAN.md — Widget bank (sidebar Sheet with categorized widgets, add functionality)
- [x] 24-05-PLAN.md — Dashboard integration (header controls, client component, page update, persistence)

### Phase 25: AI Document Intelligence
**Goal**: AI automatically extracts financial data from invoices and receipts, calculates revenue/costs, and categorizes line items
**Depends on**: Phase 22 (document management)
**Requirements**: AI-01 through AI-08
**Plans**: 5 plans

Plans:
- [x] 25-01-PLAN.md — Schema & manifest infrastructure (aiStatus field, types, manifest generation)
- [x] 25-02-PLAN.md — Prompt templates (invoice/receipt/bulk analysis prompts for Claude Code)
- [x] 25-03-PLAN.md — AI import API routes (invoice import, receipt import, pending query)
- [x] 25-04-PLAN.md — Review UI components (AIReviewSheet, ExtractionTable, ConfidenceBadge)
- [x] 25-05-PLAN.md — Integration (AI status badges, dashboard widget, auto-manifest on upload)

### Phase 26: Revenue Model Refinement
**Goal**: Clear separation between estimated and actual revenue with proper data flow
**Depends on**: Phase 25 (AI document intelligence)
**Requirements**: REV-01 through REV-05
**Plans**: 3 plans

Plans:
- [x] 26-01-PLAN.md — Schema migration (add potentialRevenue, remove aiImportedRevenue)
- [x] 26-02-PLAN.md — API route updates (conversion logic, AI import, projects API)
- [x] 26-03-PLAN.md — UI updates (FinancialsSummary redesign, remove manual revenue input)

### Phase 27: Conversion Visibility & Archive
**Goal**: Users can see conversion status on deals/potentials, navigate to converted projects, and archive completed items
**Depends on**: Phase 26 (revenue model refinement)
**Requirements**: CONV-01 through CONV-05, ARCH-01 through ARCH-04
**Plans**: 3 plans

Plans:
- [x] 27-01-PLAN.md — Schema & API updates (isArchived field, project include, archive filter)
- [x] 27-02-PLAN.md — Conversion Visibility UI (badges, View Project, variance, read-only)
- [x] 27-03-PLAN.md — Archive system UI (toggle, archive buttons, deep linking)

### Phase 28: Server Query Project Include Fix
**Goal**: Fix server-side page queries to include project relation for conversion visibility on initial load
**Depends on**: Phase 27 (conversion visibility implemented)
**Requirements**: CONV-01 (gap closure)
**Plans**: 1 plan

Plans:
- [x] 28-01-PLAN.md — Add project include to page queries

---

## Progress

| Phase | Milestone | Plans Complete | Status | Completed |
|-------|-----------|----------------|--------|-----------|
| 21. Infrastructure & Schema | v1.3 | 2/2 | Complete | 2026-01-23 |
| 22. Document Management | v1.3 | 3/3 | Complete | 2026-01-23 |
| 23. Widget Registry & Roles | v1.3 | 3/3 | Complete | 2026-01-23 |
| 24. Dashboard Customization UI | v1.3 | 5/5 | Complete | 2026-01-23 |
| 25. AI Document Intelligence | v1.3 | 5/5 | Complete | 2026-01-24 |
| 26. Revenue Model Refinement | v1.3.1 | 3/3 | Complete | 2026-01-24 |
| 27. Conversion Visibility & Archive | v1.3.2 | 3/3 | Complete | 2026-01-24 |
| 28. Server Query Project Include Fix | v1.3.2 | 1/1 | Complete | 2026-01-24 |

---

## Milestone Summary

**Key Decisions:**
- Folder-based document storage for project isolation
- react-grid-layout for dashboard customization
- AI prompts via manifest + Claude Code integration
- potentialRevenue vs revenue split for estimate/actual separation
- Archive filter off by default for clean views
- Read-only mode for converted AND lost deals
- Server queries mirror API includes for render parity

**Issues Resolved:**
- CONV-01 gap: Server queries missing project include (Phase 28)
- Profit card UI cutoff on narrow screens (Phase 26)

**Technical Debt:**
- Board TypeScript interfaces should include project field (low priority)

---

_Archived: 2026-01-24 as part of v1.3.2 milestone completion_
