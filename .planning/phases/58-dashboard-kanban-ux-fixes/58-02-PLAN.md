# Plan 58-02: Kanban Desktop Full-Card Drag & Hide Handles

## Frontmatter
- **Phase**: 58
- **Plan**: 58-02
- **Wave**: 1
- **Depends on**: None
- **Files modified**:
  - `src/components/kanban/kanban-card.tsx`
- **Autonomous**: true
- **Requirements**: BUG-05, BUG-06

## Goal
On desktop, kanban cards can be dragged by clicking anywhere on the card body (no visible dotted drag handles). On mobile, drag handles remain visible for touch-hold interaction.

## Context
Currently `kanban-card.tsx` has a dedicated drag handle div (with `GripVertical` icon) that has `md:opacity-0 md:group-hover:opacity-100`. The `dragListeners` from dnd-kit's `useSortable` are ONLY attached to this handle div. This means on desktop, users must hover to see the handle then click it to drag. The fix moves drag listeners to the entire card on desktop while keeping the handle for mobile.

## Tasks

<task id="1">
Modify `src/components/kanban/kanban-card.tsx`:

1. **Move drag listeners to the outer card div**: Change the outer `div` (the one with `ref={setNodeRef}`) to also spread `{...dragListeners}`:
   ```tsx
   <div
     ref={setNodeRef}
     style={style}
     {...attributes}
     {...dragListeners}
     className={cn(...)}
   >
   ```

   This makes the entire card draggable. The MouseSensor already has `distance: 5` activation constraint, so regular clicks still work. The TouchSensor has `delay: 250` which handles mobile touch-hold.

2. **Hide drag handle on desktop**: Change the drag handle div's classes from:
   ```
   md:opacity-0 md:group-hover:opacity-100
   ```
   to:
   ```
   md:hidden
   ```
   This completely hides the GripVertical handle on desktop. On mobile it remains visible.

3. **Remove drag listeners from handle div**: Since listeners are now on the outer div, remove `{...dragListeners}` from the handle div. Keep the handle div for mobile visual affordance only (no event handlers needed since the outer div handles drag).

4. **Remove left padding adjustment**: The card content currently has `canEdit && "pl-10 md:pl-4"` to make room for the handle. Since the handle is now `md:hidden`, change this to:
   ```
   canEdit && "pl-10 md:pl-4"
   ```
   This stays the same — on mobile, left padding accommodates the visible handle; on desktop, normal padding since handle is hidden.

5. **Ensure click-to-open still works**: The `handleClick` function on the card content div should still fire for regular clicks. Since `MouseSensor` has `distance: 5`, clicking without moving 5px will NOT trigger drag, so the click handler fires normally. Verify this logic is intact.
</task>

## Verification
1. Desktop: Click and drag a kanban card by clicking anywhere on its body — card should move between columns
2. Desktop: No visible dotted/grip drag handles anywhere on cards (not even on hover)
3. Desktop: Single click on a card opens the initiative detail sheet (not drag)
4. Mobile: Drag handle (GripVertical) is visible on the left side of each card
5. Mobile: Touch-hold on the handle initiates drag
6. Mobile: Quick tap on the card opens the initiative detail sheet

## must_haves
- [ ] Desktop kanban cards are draggable by clicking anywhere on the card body
- [ ] No visible drag handles on desktop kanban cards (not even on hover)
- [ ] Mobile kanban cards still show drag handles for touch interaction
- [ ] Single click on desktop still opens initiative detail (not drag)
