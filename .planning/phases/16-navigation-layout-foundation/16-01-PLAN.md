---
phase: 16-navigation-layout-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/globals.css
  - src/app/layout.tsx
  - src/app/(dashboard)/layout.tsx
  - src/components/layout/sidebar.tsx
  - src/components/layout/mobile-nav.tsx
autonomous: true

must_haves:
  truths:
    - "User on mobile (<768px) sees bottom navigation bar"
    - "User on mobile does not see sidebar"
    - "User on tablet/desktop sees sidebar, not bottom nav"
    - "Bottom nav shows Dashboard, Initiatives, CRM, Events"
  artifacts:
    - path: "src/components/layout/mobile-nav.tsx"
      provides: "Bottom navigation component"
      min_lines: 40
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Responsive layout wrapper"
      contains: "md:pl-64"
    - path: "src/app/globals.css"
      provides: "Safe area CSS utilities"
      contains: "pb-safe"
  key_links:
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/components/layout/mobile-nav.tsx"
      via: "import and render"
      pattern: "MobileNav"
    - from: "src/components/layout/mobile-nav.tsx"
      to: "usePathname"
      via: "active state detection"
      pattern: "usePathname"
---

<objective>
Make SAAP's layout responsive with mobile-first navigation patterns.

Purpose: Users on mobile devices need appropriate navigation - sidebar is too wide, so we hide it and show a bottom nav bar instead. This is the foundation for all subsequent responsive work.

Output: Bottom navigation component, responsive layout, safe area CSS utilities.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/16-navigation-layout-foundation/16-RESEARCH.md

Key files to modify:
@src/app/globals.css
@src/app/layout.tsx
@src/app/(dashboard)/layout.tsx
@src/components/layout/sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add safe area CSS utilities and viewport meta</name>
  <files>
    - src/app/globals.css
    - src/app/layout.tsx
  </files>
  <action>
1. In `src/app/globals.css`, add to the existing `@layer utilities` block:
```css
.pb-safe {
  padding-bottom: env(safe-area-inset-bottom);
}

.pt-safe {
  padding-top: env(safe-area-inset-top);
}
```

2. In `src/app/layout.tsx`, update the viewport meta to support iOS safe areas:
- Add viewport export:
```typescript
export const viewport: Viewport = {
  width: 'device-width',
  initialScale: 1,
  viewportFit: 'cover',
}
```
- Import `Viewport` from `next` at the top

This ensures bottom navigation doesn't overlap iOS home indicator.
  </action>
  <verify>
- `grep "pb-safe" src/app/globals.css` shows the utility class
- `grep "viewportFit" src/app/layout.tsx` shows the viewport config
  </verify>
  <done>Safe area CSS utilities exist and viewport is configured for iOS safe areas</done>
</task>

<task type="auto">
  <name>Task 2: Make dashboard layout responsive</name>
  <files>
    - src/app/(dashboard)/layout.tsx
    - src/components/layout/sidebar.tsx
  </files>
  <action>
1. In `src/components/layout/sidebar.tsx`:
- Add responsive classes to the aside element:
  - Change `className="fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200"`
  - To: `className="hidden md:fixed md:inset-y-0 md:left-0 md:z-50 md:block md:w-64 bg-white border-r border-gray-200"`
- This hides the sidebar completely on mobile (<768px)

2. In `src/app/(dashboard)/layout.tsx`:
- Change `<main className="pl-64">` to `<main className="md:pl-64 pb-16 md:pb-0">`
- This removes left padding on mobile (no sidebar) and adds bottom padding for mobile nav
- Add placeholder comment for MobileNav (will be added in Task 3):
  ```tsx
  {/* Mobile bottom navigation - added in Task 3 */}
  ```

The layout will be fully functional for desktop but mobile will lack navigation until Task 3.
  </action>
  <verify>
- `grep "hidden md:fixed" src/components/layout/sidebar.tsx` confirms responsive sidebar
- `grep "md:pl-64 pb-16" src/app/(dashboard)/layout.tsx` confirms responsive padding
  </verify>
  <done>Sidebar hidden on mobile, main content takes full width on mobile with bottom padding for nav</done>
</task>

<task type="auto">
  <name>Task 3: Create MobileNav bottom navigation component</name>
  <files>
    - src/components/layout/mobile-nav.tsx
    - src/app/(dashboard)/layout.tsx
  </files>
  <action>
1. Create `src/components/layout/mobile-nav.tsx`:
```typescript
'use client'

import Link from 'next/link'
import { usePathname } from 'next/navigation'
import { LayoutDashboard, ListTodo, Funnel, Ticket } from 'lucide-react'
import { cn } from '@/lib/utils'

const mobileNavItems = [
  { name: 'Dashboard', href: '/', icon: LayoutDashboard },
  { name: 'Initiatives', href: '/initiatives', icon: ListTodo },
  { name: 'CRM', href: '/pipeline', icon: Funnel },
  { name: 'Events', href: '/events', icon: Ticket },
]

export function MobileNav() {
  const pathname = usePathname()

  return (
    <nav className={cn(
      "fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200",
      "pb-safe md:hidden"
    )}>
      <div className="grid h-16 grid-cols-4 max-w-lg mx-auto">
        {mobileNavItems.map((item) => {
          const isActive = pathname === item.href ||
            (item.href !== '/' && pathname.startsWith(item.href))
          return (
            <Link
              key={item.href}
              href={item.href}
              className={cn(
                "inline-flex flex-col items-center justify-center",
                "min-h-[48px] min-w-[48px]",
                "text-gray-500 hover:text-gray-900 transition-colors",
                isActive && "text-blue-600"
              )}
            >
              <item.icon className="w-6 h-6 mb-1" />
              <span className="text-xs font-medium">{item.name}</span>
            </Link>
          )
        })}
      </div>
    </nav>
  )
}
```

2. Update `src/app/(dashboard)/layout.tsx` to include MobileNav:
- Import: `import { MobileNav } from '@/components/layout/mobile-nav'`
- Add `<MobileNav />` inside the div, after the main element
- Final structure:
```tsx
<div className="min-h-screen">
  <Sidebar />
  <main className="md:pl-64 pb-16 md:pb-0">
    {children}
  </main>
  <MobileNav />
</div>
```

The bottom nav has:
- 4 items: Dashboard, Initiatives, CRM (links to Pipeline), Events
- 48px touch targets (min-h-[48px] min-w-[48px])
- Active state highlighting (blue-600)
- Safe area padding for iOS (pb-safe)
- Hidden on md+ screens (md:hidden)
  </action>
  <verify>
- `ls src/components/layout/mobile-nav.tsx` confirms file exists
- `grep "MobileNav" src/app/(dashboard)/layout.tsx` confirms import and usage
- Resize browser to <768px width to see bottom nav appear
  </verify>
  <done>Bottom navigation visible on mobile with 4 key nav items, hidden on tablet/desktop</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Open app in browser at full desktop width - sidebar visible on left, no bottom nav
2. Resize browser to mobile width (<768px) - sidebar disappears, bottom nav appears at bottom
3. Tap each bottom nav item - navigates to correct page, shows active state
4. On iOS (or simulator) - bottom nav doesn't overlap home indicator
</verification>

<success_criteria>
- NAV-01: Bottom navigation bar appears on mobile screens (<768px) - DONE via md:hidden on MobileNav
- NAV-02: Bottom nav includes Dashboard, Initiatives, CRM, Events - DONE via mobileNavItems
- NAV-03: Sidebar hidden on mobile, visible on tablet/desktop - DONE via hidden md:block on Sidebar
- User can navigate between all 4 sections on mobile using bottom nav
</success_criteria>

<output>
After completion, create `.planning/phases/16-navigation-layout-foundation/16-01-SUMMARY.md`
</output>
