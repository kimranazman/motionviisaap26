---
wave: 1
depends_on: []
files_modified:
  - src/lib/nav-config.ts
  - src/components/layout/sidebar.tsx
  - src/components/layout/mobile-sidebar.tsx
autonomous: true
---

# Plan 75-01: Move Members to Work Group

## Objective

Move the Members nav item from top-level navigation (`topLevelItems`) to nested under the Work group in `navGroups`, appearing after Projects and Tasks.

## Context

**Current state:**
- Members is defined in `topLevelItems` array (line 89-95 of nav-config.ts)
- Members has children: Khairul, Azlan, Izyani (expandable)
- Desktop sidebar renders top-level items in a separate section (lines 91-183 of sidebar.tsx)
- Mobile sidebar duplicates this rendering logic (lines 102-198 of mobile-sidebar.tsx)
- `NavGroupComponent` already supports nested items with children (see Companies with Departments, Contacts)

**Target state:**
- Members moved to Work group items, after Projects and Tasks
- `topLevelItems` becomes empty array (no top-level items remain)
- Desktop and mobile sidebars no longer render top-level items section
- Members children (Khairul, Azlan, Izyani) continue to function via NavGroupComponent's nested rendering

## Tasks

<task id="1">
<title>Move Members to Work group in nav-config.ts</title>
<file>src/lib/nav-config.ts</file>
<action>
1. Move the Members NavItem from `topLevelItems` array to `navGroups[1].items` (Work group)
2. Place Members after Tasks (third item in Work group)
3. Set `topLevelItems` to an empty array
4. Keep Members with its children array (Khairul, Azlan, Izyani)
</action>
<change_description>
In the Work group (key: 'work'), add Members with children after Tasks:

```typescript
{
  key: 'work',
  label: 'Work',
  items: [
    { name: 'Projects', href: '/projects', icon: Briefcase },
    { name: 'Tasks', href: '/tasks', icon: ListChecks },
    { name: 'Members', href: '/members', icon: Users2, children: [
      { name: 'Khairul', href: '/members/khairul', icon: User },
      { name: 'Azlan', href: '/members/azlan', icon: User },
      { name: 'Izyani', href: '/members/izyani', icon: User },
    ]},
  ],
},
```

Change topLevelItems to empty:
```typescript
export const topLevelItems: TopLevelNavItem[] = []
```
</change_description>
</task>

<task id="2">
<title>Remove top-level items rendering from desktop sidebar</title>
<file>src/components/layout/sidebar.tsx</file>
<action>
1. Remove the entire "Top-level items (Members)" section (lines 90-183)
2. Remove associated state: `expandedTopLevel` and `setExpandedTopLevel`
3. Remove the `useEffect` that auto-expands top-level items
4. Remove the `toggleTopLevel` function
5. Remove `visibleTopLevel` useMemo
</action>
<change_description>
Delete these code blocks:
- Lines 33-36: `visibleTopLevel` useMemo
- Lines 39-57: `expandedTopLevel` state and auto-expand useEffect
- Lines 55-57: `toggleTopLevel` function
- Lines 90-183: Entire top-level items rendering section (the div with className "mt-4 flex flex-col gap-1")

The sidebar will only render:
1. Collapsible nav groups (including Work with Members)
2. Settings at the bottom
</change_description>
</task>

<task id="3">
<title>Remove top-level items rendering from mobile sidebar</title>
<file>src/components/layout/mobile-sidebar.tsx</file>
<action>
1. Remove the entire "Top-level items (Members)" section (lines 102-198)
2. Remove associated state: `expandedTopLevel` and `setExpandedTopLevel`
3. Remove the `useEffect` that auto-expands top-level items
4. Remove the `toggleTopLevel` function
5. Remove `visibleTopLevel` useMemo
</action>
<change_description>
Delete these code blocks:
- Lines 36-39: `visibleTopLevel` useMemo
- Lines 42-60: `expandedTopLevel` state and auto-expand useEffect
- Lines 58-60: `toggleTopLevel` function
- Lines 102-198: Entire top-level items rendering section

The mobile sidebar will only render:
1. Collapsible nav groups (including Work with Members)
2. Settings at the bottom
</change_description>
</task>

## Verification

<verify>
- [ ] `nav-config.ts` compiles without errors
- [ ] Members appears in Work group items array with children
- [ ] `topLevelItems` is an empty array
- [ ] Desktop sidebar compiles without errors (no unused imports)
- [ ] Mobile sidebar compiles without errors (no unused imports)
- [ ] No references to `topLevelItems` in sidebar components (they may import but not use)
</verify>

## must_haves

These are derived from Phase 75 success criteria:

1. **Members removed from top-level** — topLevelItems array is empty; sidebar components don't render top-level section
2. **Members under Work group** — Members NavItem in navGroups[1].items after Projects, Tasks
3. **Children preserved** — Members has children array with Khairul, Azlan, Izyani
4. **NavGroupComponent handles nesting** — No changes needed; it already supports children (see Companies)
5. **Active route highlighting** — Handled by NavGroupComponent's `isItemActive` function

## Rollback

If issues arise:
1. Restore Members to `topLevelItems`
2. Restore top-level rendering sections in both sidebar components
3. Remove Members from Work group items
