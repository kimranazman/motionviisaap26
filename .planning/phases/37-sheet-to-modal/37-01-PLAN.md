---
phase: 37-sheet-to-modal
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/projects/project-detail-sheet.tsx
autonomous: true

must_haves:
  truths:
    - "Documents section displays when project has uploaded documents"
    - "Documents load on sheet open (no fetch errors)"
    - "Document actions work (preview, review, delete)"
  artifacts:
    - path: "src/components/projects/project-detail-sheet.tsx"
      provides: "DocumentsSection rendering with documents prop"
      contains: "DocumentsSection"
  key_links:
    - from: "src/components/projects/project-detail-sheet.tsx"
      to: "/api/projects/{id}/documents"
      via: "useEffect fetch on open"
      pattern: "fetch.*api/projects.*documents"
---

<objective>
Debug and fix documents not displaying in project detail sheet.

Purpose: Users report documents no longer show in project detail after v1.4.1. Need to identify root cause and fix.

Output: Working documents display in project detail sheet.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/37-sheet-to-modal/37-RESEARCH.md

Key context from research:
- Documents fetch logic at lines 494-508 looks correct
- DocumentsSection renders when documents.length > 0
- Need browser debugging to find actual issue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Investigate documents display issue</name>
  <files>src/components/projects/project-detail-sheet.tsx</files>
  <action>
Debug why documents don't display in project detail:

1. Check the documents state and fetch logic (around lines 494-508):
   - Verify useEffect dependencies are correct ([project?.id, open])
   - Check if there's a race condition with project loading
   - Look for any early returns that might skip the fetch

2. Check DocumentsSection rendering (look for conditional rendering):
   - Find where DocumentsSection is rendered
   - Check if there's a condition that might hide it
   - Verify props being passed to DocumentsSection

3. Check recent commits that might have broken it:
   - Look at git history for changes to this file
   - Check if any related API changes occurred

4. Common causes to check:
   - State initialization timing
   - Conditional rendering with wrong condition
   - API response format change
   - Tab/accordion hiding the section

Once root cause is found, apply minimal fix to restore documents display.

DO NOT change component to Dialog in this task - that's handled in plan 37-02.
  </action>
  <verify>
1. Open a project that has documents in the database
2. Check browser console for errors
3. Check Network tab for /api/projects/{id}/documents call
4. Verify documents appear in the Documents section
  </verify>
  <done>
Documents section displays correctly when project has uploaded documents. No console errors.
  </done>
</task>

</tasks>

<verification>
Manual verification:
1. Open project detail for a project with documents
2. Documents section shows with file list
3. Can click document to preview
4. Can click AI review button
5. Can delete document
</verification>

<success_criteria>
- Documents fetch on sheet open (visible in Network tab)
- DocumentsSection renders with document list
- All document actions work (preview, review, delete)
</success_criteria>

<output>
After completion, create `.planning/phases/37-sheet-to-modal/37-01-SUMMARY.md`
</output>
