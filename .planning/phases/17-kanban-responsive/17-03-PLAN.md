---
phase: 17-kanban-responsive
plan: 03
type: execute
wave: 3
depends_on: ["17-02"]
files_modified:
  - src/components/kanban/kanban-card.tsx
  - src/components/pipeline/pipeline-card.tsx
  - src/components/potential-projects/potential-card.tsx
  - src/components/kanban/kanban-filter-bar.tsx
  - src/components/kanban/kanban-board.tsx
autonomous: false

must_haves:
  truths:
    - "User on mobile can tap quick actions button without hovering"
    - "User on mobile can access filter controls by scrolling horizontally"
    - "User on mobile can clear filters with visible button"
  artifacts:
    - path: "src/components/kanban/kanban-card.tsx"
      provides: "Always-visible quick actions on mobile"
      contains: "md:opacity-0 md:group-hover:opacity-100"
    - path: "src/components/pipeline/pipeline-card.tsx"
      provides: "Quick actions menu with responsive visibility"
      contains: "md:opacity-0 md:group-hover:opacity-100"
    - path: "src/components/potential-projects/potential-card.tsx"
      provides: "Quick actions menu with responsive visibility"
      contains: "md:opacity-0 md:group-hover:opacity-100"
    - path: "src/components/kanban/kanban-filter-bar.tsx"
      provides: "Horizontally scrollable filter bar"
      contains: "overflow-x-auto"
  key_links:
    - from: "KanbanCard quick actions"
      to: "DropdownMenu"
      via: "Always visible on mobile, hover on desktop"
      pattern: "md:opacity-0"
    - from: "PipelineCard quick actions"
      to: "DropdownMenu"
      via: "Always visible on mobile, hover on desktop"
      pattern: "md:opacity-0"
    - from: "PotentialCard quick actions"
      to: "DropdownMenu"
      via: "Always visible on mobile, hover on desktop"
      pattern: "md:opacity-0"
---

<objective>
Make quick actions visible on mobile across ALL Kanban boards and filter bar horizontally scrollable.

Purpose: Quick actions are currently hover-only (unusable on touch). Filter bar is too wide for mobile. Fix both for touch accessibility across Initiatives, Pipeline, and Potentials boards.
Output: Quick actions button always visible on mobile on all card types; filter bar scrolls horizontally on mobile.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/17-kanban-responsive/17-RESEARCH.md
@.planning/phases/17-kanban-responsive/17-01-SUMMARY.md
@.planning/phases/17-kanban-responsive/17-02-SUMMARY.md

@src/components/kanban/kanban-card.tsx
@src/components/pipeline/pipeline-card.tsx
@src/components/potential-projects/potential-card.tsx
@src/components/kanban/kanban-filter-bar.tsx
@src/components/kanban/kanban-board.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Make quick actions visible on mobile for ALL Kanban cards</name>
  <files>
    src/components/kanban/kanban-card.tsx
    src/components/pipeline/pipeline-card.tsx
    src/components/potential-projects/potential-card.tsx
  </files>
  <action>
Update ALL card components to have quick actions that are always visible on mobile, hover-only on desktop.

**1. KanbanCard (kanban-card.tsx) - UPDATE EXISTING:**

Current implementation has quick actions in an absolutely positioned div that's only visible on hover:
```typescript
<div className="absolute -top-2 -right-2 opacity-0 group-hover:opacity-100 ...">
```

Move the quick actions INSIDE the card content, in the header row. Replace with:
```typescript
{/* Card Content */}
<div className="p-4">
  {/* Header with title and quick actions */}
  <div className="flex items-start justify-between gap-2 mb-3">
    {/* Title - Primary focus */}
    <div
      className="text-sm font-medium text-gray-900 hover:text-blue-600 line-clamp-2 cursor-pointer flex-1"
      onClick={handleViewDetails}
      onPointerDown={(e) => e.stopPropagation()}
    >
      {item.title}
    </div>

    {/* Quick Actions - visible on mobile, hover on desktop */}
    {canEdit && (
      <DropdownMenu>
        <DropdownMenuTrigger asChild>
          <Button
            size="icon"
            variant="ghost"
            className={cn(
              "h-8 w-8 -mr-2 -mt-1 shrink-0",
              // Mobile: always visible
              // Desktop: visible on hover
              "md:opacity-0 md:group-hover:opacity-100",
              "focus:opacity-100",
              "transition-opacity"
            )}
            onPointerDown={(e) => e.stopPropagation()}
            onClick={(e) => e.stopPropagation()}
          >
            <MoreHorizontal className="h-4 w-4 text-gray-500" />
          </Button>
        </DropdownMenuTrigger>
        <DropdownMenuContent align="end" className="w-40">
          {/* Keep existing menu items: View Details, Change Status, Reassign */}
        </DropdownMenuContent>
      </DropdownMenu>
    )}
  </div>

  {/* Footer - KR Badge, Date, Avatar */}
  <div className="flex items-center justify-between">
    {/* ... existing footer content ... */}
  </div>
</div>
```

Remove the old absolutely positioned quick actions div.

**2. PipelineCard (pipeline-card.tsx) - ADD NEW:**

Currently has NO quick actions menu. Add one with View Details option.

Add imports at top:
```typescript
import { MoreHorizontal, Eye } from 'lucide-react'
import { Button } from '@/components/ui/button'
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu'
```

Update the card content structure to include quick actions:
```typescript
{/* Card Content */}
<div className="p-4">
  {/* Header with title and quick actions */}
  <div className="flex items-start justify-between gap-2 mb-3">
    {/* Title - Primary focus */}
    <div className="text-sm font-medium text-gray-900 line-clamp-2 flex-1">
      {deal.title}
    </div>

    {/* Quick Actions - visible on mobile, hover on desktop */}
    {canEdit && (
      <DropdownMenu>
        <DropdownMenuTrigger asChild>
          <Button
            size="icon"
            variant="ghost"
            className={cn(
              "h-8 w-8 -mr-2 -mt-1 shrink-0",
              "md:opacity-0 md:group-hover:opacity-100",
              "focus:opacity-100",
              "transition-opacity"
            )}
            onPointerDown={(e) => e.stopPropagation()}
            onClick={(e) => {
              e.stopPropagation()
            }}
          >
            <MoreHorizontal className="h-4 w-4 text-gray-500" />
          </Button>
        </DropdownMenuTrigger>
        <DropdownMenuContent align="end" className="w-40">
          <DropdownMenuItem
            onClick={(e) => {
              e.stopPropagation()
              onClick?.()
            }}
            onPointerDown={(e) => e.stopPropagation()}
          >
            <Eye className="h-4 w-4 mr-2" />
            View Details
          </DropdownMenuItem>
        </DropdownMenuContent>
      </DropdownMenu>
    )}
  </div>

  {/* Value */}
  {deal.value !== null && (
    <div className="text-sm font-semibold text-green-600 mb-3">
      {formatCurrency(deal.value)}
    </div>
  )}

  {/* Footer - Company & Contact */}
  {/* ... existing footer ... */}
</div>
```

**3. PotentialCard (potential-card.tsx) - ADD NEW:**

Same pattern as PipelineCard. Add the same imports and quick actions structure:

Add imports at top:
```typescript
import { MoreHorizontal, Eye } from 'lucide-react'
import { Button } from '@/components/ui/button'
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu'
```

Update card content with quick actions in header:
```typescript
{/* Card Content */}
<div className="p-4">
  {/* Header with title and quick actions */}
  <div className="flex items-start justify-between gap-2 mb-3">
    {/* Title - Primary focus */}
    <div className="text-sm font-medium text-gray-900 line-clamp-2 flex-1">
      {project.title}
    </div>

    {/* Quick Actions - visible on mobile, hover on desktop */}
    {canEdit && (
      <DropdownMenu>
        <DropdownMenuTrigger asChild>
          <Button
            size="icon"
            variant="ghost"
            className={cn(
              "h-8 w-8 -mr-2 -mt-1 shrink-0",
              "md:opacity-0 md:group-hover:opacity-100",
              "focus:opacity-100",
              "transition-opacity"
            )}
            onPointerDown={(e) => e.stopPropagation()}
            onClick={(e) => {
              e.stopPropagation()
            }}
          >
            <MoreHorizontal className="h-4 w-4 text-gray-500" />
          </Button>
        </DropdownMenuTrigger>
        <DropdownMenuContent align="end" className="w-40">
          <DropdownMenuItem
            onClick={(e) => {
              e.stopPropagation()
              onClick?.()
            }}
            onPointerDown={(e) => e.stopPropagation()}
          >
            <Eye className="h-4 w-4 mr-2" />
            View Details
          </DropdownMenuItem>
        </DropdownMenuContent>
      </DropdownMenu>
    )}
  </div>

  {/* Value */}
  {project.estimatedValue !== null && (
    <div className="text-sm font-semibold text-green-600 mb-3">
      {formatCurrency(project.estimatedValue)}
    </div>
  )}

  {/* Footer - Company & Contact */}
  {/* ... existing footer ... */}
</div>
```
  </action>
  <verify>
- `npm run build` passes
- grep for "md:opacity-0 md:group-hover:opacity-100" in all three card files:
  - `grep "md:opacity-0 md:group-hover:opacity-100" src/components/kanban/kanban-card.tsx`
  - `grep "md:opacity-0 md:group-hover:opacity-100" src/components/pipeline/pipeline-card.tsx`
  - `grep "md:opacity-0 md:group-hover:opacity-100" src/components/potential-projects/potential-card.tsx`
  </verify>
  <done>
All three card components (KanbanCard, PipelineCard, PotentialCard) have quick actions button that is always visible on mobile, hover-only on desktop (md:opacity-0 md:group-hover:opacity-100).
  </done>
</task>

<task type="auto">
  <name>Task 2: Make filter bar horizontally scrollable on mobile</name>
  <files>src/components/kanban/kanban-filter-bar.tsx</files>
  <action>
Update the filter bar container to scroll horizontally on mobile.

NOTE: Only the Initiatives board (KanbanBoard) uses KanbanFilterBar. Pipeline and Potentials boards do not have filter bars - they only have simple headers with "Add" buttons. This task only affects the Initiatives board, which is correct behavior.

Current container:
```typescript
<div className="flex items-center gap-3 p-3 bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl shadow-sm">
```

Update to:
```typescript
<div className={cn(
  "flex items-center gap-3 p-3",
  "bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl shadow-sm",
  // Mobile: horizontal scroll
  "overflow-x-auto",
  // Desktop: no scroll needed
  "md:overflow-visible"
)}>
```

Also hide the vertical separators on mobile (they break scroll flow):
```typescript
{/* Separator - hidden on mobile */}
<div className="hidden md:block h-6 w-px bg-gray-200" />
```

Apply this to all 4 separator divs in the filter bar.

Import cn from @/lib/utils if not already imported (it should already be there).
  </action>
  <verify>
- `npm run build` passes
- grep for "overflow-x-auto" in kanban-filter-bar.tsx
- grep for "hidden md:block" in kanban-filter-bar.tsx shows separators hidden on mobile
  </verify>
  <done>
Filter bar scrolls horizontally on mobile, separators hidden on mobile to improve scroll flow. Pipeline and Potentials boards are unaffected (they don't use filter bars).
  </done>
</task>

<task type="auto">
  <name>Task 3: Update filter bar wrapper in KanbanBoard for responsive layout</name>
  <files>src/components/kanban/kanban-board.tsx</files>
  <action>
The filter bar and view toggle are in a flex row that may not wrap well on mobile.

Current layout:
```typescript
<div className="flex items-center justify-between gap-4">
  <KanbanFilterBar ... />
  {/* View Toggle */}
  <Tabs ...>
```

Update to stack on mobile:
```typescript
<div className={cn(
  "flex gap-4",
  // Mobile: stack vertically
  "flex-col",
  // Desktop: horizontal row
  "md:flex-row md:items-center md:justify-between"
)}>
  <KanbanFilterBar ... />
  {/* View Toggle - full width on mobile */}
  <Tabs
    value={viewMode}
    onValueChange={(v) => setViewMode(v as ViewMode)}
    className="shrink-0 w-full md:w-auto"
  >
```

Import cn from @/lib/utils if not already imported.
  </action>
  <verify>
- `npm run build` passes
- grep for "flex-col" in kanban-board.tsx in the filter wrapper section
  </verify>
  <done>
Filter bar and view toggle stack vertically on mobile, horizontal on desktop.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete responsive Kanban boards with:
    - Touch-friendly drag-and-drop (250ms hold to drag)
    - Horizontal scroll with snap points on mobile
    - 75% viewport width columns showing adjacent edges
    - Always-visible quick actions on mobile (ALL boards)
    - Scrollable filter bar on mobile (Initiatives only - Pipeline/Potentials don't have filters)
  </what-built>
  <how-to-verify>
    1. Open http://localhost:3000/initiatives in mobile device or browser DevTools (iPhone SE viewport)
    2. Verify columns are ~75% width and you can see edge of next column
    3. Swipe horizontally - columns should snap into place
    4. Tap the 3-dot menu on a card - should be visible without hovering
    5. Tap and hold a card for 250ms - should start dragging
    6. Check filter bar scrolls horizontally if too wide
    7. Open http://localhost:3000/crm/pipeline - verify quick actions visible on cards
    8. Open http://localhost:3000/crm/potentials - verify quick actions visible on cards
    9. Test on desktop - hover behavior should still work, layout unchanged
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues found</resume-signal>
</task>

</tasks>

<verification>
1. Build passes: `npm run build` completes without errors
2. Quick actions mobile visibility on ALL card types:
   - `grep "md:opacity-0 md:group-hover:opacity-100" src/components/kanban/kanban-card.tsx`
   - `grep "md:opacity-0 md:group-hover:opacity-100" src/components/pipeline/pipeline-card.tsx`
   - `grep "md:opacity-0 md:group-hover:opacity-100" src/components/potential-projects/potential-card.tsx`
3. Filter bar scrollable:
   - `grep "overflow-x-auto" src/components/kanban/kanban-filter-bar.tsx`
4. Visual verification on mobile viewport (checkpoint task)
</verification>

<success_criteria>
- KanbanCard quick actions button visible on mobile, hover-only on desktop
- PipelineCard quick actions button visible on mobile, hover-only on desktop
- PotentialCard quick actions button visible on mobile, hover-only on desktop
- Filter bar scrolls horizontally on mobile (Initiatives board only)
- Filter bar separators hidden on mobile
- All functionality works on Initiatives, Pipeline, and Potentials boards
- User verification confirms touch interactions work correctly
</success_criteria>

<output>
After completion, create `.planning/phases/17-kanban-responsive/17-03-SUMMARY.md`
</output>
