---
phase: 39-by-objective-hierarchy-view
plan: 02
type: execute
wave: 2
depends_on: ["39-01"]
files_modified:
  - src/components/objectives/view-mode-toggle.tsx
  - src/components/objectives/objective-hierarchy.tsx
  - src/app/(dashboard)/initiatives/page.tsx
  - src/app/(dashboard)/kanban/page.tsx
  - src/app/(dashboard)/timeline/page.tsx
  - src/app/(dashboard)/calendar/page.tsx
autonomous: true

must_haves:
  truths:
    - "User sees a view mode toggle bar on the /objectives page"
    - "User sees the same view mode toggle bar on /initiatives, /kanban, /timeline, and /calendar pages"
    - "Clicking a toggle option navigates to that view's route"
    - "The active view is visually highlighted based on the current URL"
    - "By Objective is the first/default option in the toggle"
  artifacts:
    - path: "src/components/objectives/view-mode-toggle.tsx"
      provides: "Pill-style navigation toggle for 5 view modes"
      contains: "'use client'"
    - path: "src/components/objectives/objective-hierarchy.tsx"
      provides: "Updated to include ViewModeToggle"
      contains: "ViewModeToggle"
    - path: "src/app/(dashboard)/initiatives/page.tsx"
      provides: "Updated to include ViewModeToggle"
      contains: "ViewModeToggle"
    - path: "src/app/(dashboard)/kanban/page.tsx"
      provides: "Updated to include ViewModeToggle"
      contains: "ViewModeToggle"
    - path: "src/app/(dashboard)/timeline/page.tsx"
      provides: "Updated to include ViewModeToggle"
      contains: "ViewModeToggle"
    - path: "src/app/(dashboard)/calendar/page.tsx"
      provides: "Updated to include ViewModeToggle"
      contains: "ViewModeToggle"
  key_links:
    - from: "src/components/objectives/view-mode-toggle.tsx"
      to: "next/navigation usePathname"
      via: "route-based active state detection"
      pattern: "usePathname"
    - from: "src/components/objectives/view-mode-toggle.tsx"
      to: "5 view routes"
      via: "next/link navigation"
      pattern: "Link.*href"
---

<objective>
Create a ViewModeToggle component and integrate it into all 5 initiative view pages so users can seamlessly switch between By Objective, List, Kanban, Timeline, and Calendar views.

Purpose: Fulfills VIEW-06 -- users can toggle between all view modes from any view page. Uses route-based navigation (not tabs) since each view is a separate route with different data requirements.
Output: A reusable ViewModeToggle component rendered on all 5 view pages with active state highlighting.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/39-by-objective-hierarchy-view/39-RESEARCH.md
@.planning/phases/39-by-objective-hierarchy-view/39-01-SUMMARY.md

Key existing files to reference:
@src/components/objectives/objective-hierarchy.tsx (from plan 39-01, needs ViewModeToggle added)
@src/app/(dashboard)/initiatives/page.tsx
@src/app/(dashboard)/kanban/page.tsx
@src/app/(dashboard)/timeline/page.tsx
@src/app/(dashboard)/calendar/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ViewModeToggle component</name>
  <files>
    src/components/objectives/view-mode-toggle.tsx
  </files>
  <action>
Create `src/components/objectives/view-mode-toggle.tsx`:

- `'use client'` directive
- Import `Link` from `next/link`, `usePathname` from `next/navigation`
- Import `cn` from `@/lib/utils`
- Import icons from `lucide-react`: `Target`, `List`, `KanbanSquare`, `GanttChart`, `Calendar`

Define VIEW_MODES array:
```
const VIEW_MODES = [
  { name: 'By Objective', href: '/objectives', icon: Target },
  { name: 'List', href: '/initiatives', icon: List },
  { name: 'Kanban', href: '/kanban', icon: KanbanSquare },
  { name: 'Timeline', href: '/timeline', icon: GanttChart },
  { name: 'Calendar', href: '/calendar', icon: Calendar },
]
```

Export `ViewModeToggle` component:
- Uses `usePathname()` to determine active route
- Renders a horizontal pill-style container: `inline-flex items-center rounded-lg bg-white border border-gray-200 p-1 shadow-sm`
- Maps over VIEW_MODES, each as a `<Link>`:
  - Active state: `pathname === mode.href`
  - Active styles: `bg-gray-100 text-gray-900 shadow-sm` (solid background, dark text)
  - Inactive styles: `text-gray-500 hover:text-gray-700 hover:bg-gray-50`
  - Each pill: `inline-flex items-center gap-1.5 rounded-md px-3 py-1.5 text-sm font-medium transition-all`
  - Icon: `<mode.icon className="h-4 w-4" />`
  - Label: `{mode.name}`
- On mobile (small screens): Use responsive classes to make the toggle horizontally scrollable. Wrap in a `<div className="overflow-x-auto -mx-6 px-6">` in the parent if needed. OR: hide labels on mobile and show only icons: use `<span className="hidden sm:inline">{mode.name}</span>` for the label text.

This is a PURE navigation component -- no state management, no data fetching. It reads the current pathname and renders links.
  </action>
  <verify>
1. File exists at src/components/objectives/view-mode-toggle.tsx
2. Contains 'use client' directive
3. Contains all 5 view mode entries
4. Uses usePathname for active detection (not useState)
5. Uses Link for navigation (not button with router.push)
  </verify>
  <done>
- ViewModeToggle renders 5 view options with icons
- Active view highlighted based on current URL pathname
- Clicking any option navigates to that route via Link
- Responsive: shows icons + labels on desktop, icons only on mobile
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate ViewModeToggle into all 5 view pages</name>
  <files>
    src/components/objectives/objective-hierarchy.tsx
    src/app/(dashboard)/initiatives/page.tsx
    src/app/(dashboard)/kanban/page.tsx
    src/app/(dashboard)/timeline/page.tsx
    src/app/(dashboard)/calendar/page.tsx
  </files>
  <action>
Add the ViewModeToggle to all 5 view pages. The toggle should appear BELOW the Header and ABOVE the main content, in a consistent position across all pages.

**1. `src/components/objectives/objective-hierarchy.tsx`** (client component -- 39-01 created this)
- Import `ViewModeToggle` from `@/components/objectives/view-mode-toggle`
- Add `<ViewModeToggle />` as the first element inside the component's return, BEFORE the hierarchy content
- Wrap in a margin div: `<div className="mb-6"><ViewModeToggle /></div>`

**2. `src/app/(dashboard)/initiatives/page.tsx`** (Server Component)
- This is a Server Component, but ViewModeToggle is a client component. This is fine -- Server Components can render Client Components.
- Import `ViewModeToggle` from `@/components/objectives/view-mode-toggle`
- Add `<ViewModeToggle />` inside the `<div className="p-6">` wrapper, BEFORE the existing content (the InitiativesList component)
- Wrap in: `<div className="mb-6"><ViewModeToggle /></div>`
- Read the current file first to understand its exact structure before modifying

**3. `src/app/(dashboard)/kanban/page.tsx`** (Server Component)
- Import `ViewModeToggle` from `@/components/objectives/view-mode-toggle`
- Add `<div className="mb-6 px-6"><ViewModeToggle /></div>` AFTER the Header and BEFORE the `<div className="p-6 overflow-x-auto">` containing KanbanBoard
- NOTE: The kanban page has `overflow-x-auto` on its wrapper. Place the toggle OUTSIDE this wrapper so it doesn't scroll with the board.

**4. `src/app/(dashboard)/timeline/page.tsx`** (Server Component)
- Import `ViewModeToggle` from `@/components/objectives/view-mode-toggle`
- Add `<div className="mb-6"><ViewModeToggle /></div>` inside the content wrapper, BEFORE the GanttChart
- Read the current file first to understand its exact structure before modifying

**5. `src/app/(dashboard)/calendar/page.tsx`** (Server Component)
- Import `ViewModeToggle` from `@/components/objectives/view-mode-toggle`
- Add `<div className="mb-6"><ViewModeToggle /></div>` inside the content wrapper, BEFORE the CalendarView
- Read the current file first to understand its exact structure before modifying

IMPORTANT: For each page, READ the file first before modifying. Each page has slightly different structure. Place the toggle consistently: after Header, before main content, with mb-6 spacing.

Do NOT modify the existing component logic, data fetching, or styling of these pages. Only ADD the ViewModeToggle import and render.
  </action>
  <verify>
1. Run `npx next build` to verify no TypeScript or build errors
2. Grep for "ViewModeToggle" in all 5 page/component files -- must appear in each
3. Navigate to each route (/objectives, /initiatives, /kanban, /timeline, /calendar) and confirm toggle is visible
4. Click toggle options and confirm navigation works between all 5 views
5. Confirm active state highlights correctly on each page
  </verify>
  <done>
- ViewModeToggle visible on /objectives page
- ViewModeToggle visible on /initiatives page
- ViewModeToggle visible on /kanban page
- ViewModeToggle visible on /timeline page
- ViewModeToggle visible on /calendar page
- Active state correctly highlights current route on all 5 pages
- Clicking any toggle option navigates to correct route
  </done>
</task>

</tasks>

<verification>
1. `npx next build` completes without errors
2. All 5 view pages show the ViewModeToggle component
3. Toggle active state correctly reflects current route
4. Clicking any toggle option navigates to the correct page
5. By Objective is listed first in the toggle
6. Toggle is responsive (icons only on mobile, icons + labels on desktop)
</verification>

<success_criteria>
- VIEW-06: User can toggle between By Objective, List, Kanban, Timeline, and Calendar views
- Toggle uses route navigation (not in-page tab switching)
- Active view is visually distinguished
- Consistent placement across all 5 view pages
</success_criteria>

<output>
After completion, create `.planning/phases/39-by-objective-hierarchy-view/39-02-SUMMARY.md`
</output>
