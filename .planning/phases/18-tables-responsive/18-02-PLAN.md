---
phase: 18-tables-responsive
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/initiatives/initiatives-list.tsx
autonomous: true

must_haves:
  truths:
    - "User on mobile sees # column, Initiative title with status badge inline, and Actions column"
    - "User on mobile can tap visible action button to view initiative"
    - "User on mobile can use search, status filter, and department filter without overflow"
    - "User on tablet+ sees all 8 columns"
  artifacts:
    - path: "src/components/initiatives/initiatives-list.tsx"
      provides: "Responsive initiatives table with priority columns"
      contains: "hidden md:table-cell"
  key_links:
    - from: "TableRow"
      to: "group class"
      via: "hover detection for actions"
      pattern: "group.*hover"
    - from: "Action button"
      to: "opacity classes"
      via: "mobile-visible, desktop-hover pattern"
      pattern: "md:opacity-0.*md:group-hover:opacity-100"
---

<objective>
Make Initiatives list table work effectively on mobile devices with priority columns and touch-friendly actions.

Purpose: Users can browse initiatives on any device without horizontal scrolling, with quick access to view details.
Output: Responsive initiatives-list.tsx with mobile column visibility and touch-friendly action button.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/18-tables-responsive/18-RESEARCH.md

@src/components/initiatives/initiatives-list.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Responsive toolbar for initiatives</name>
  <files>src/components/initiatives/initiatives-list.tsx</files>
  <action>
Update the toolbar section to stack properly on mobile:

1. The outer flex container has `flex-col gap-4 sm:flex-row` - verify this exists
2. Update the inner filter group to stack on mobile:
   - Change `flex flex-1 items-center gap-4` to `flex flex-col sm:flex-row flex-1 items-stretch sm:items-center gap-3 sm:gap-4`
3. Make search input full width on mobile:
   - Change `relative flex-1 max-w-sm` to `relative flex-1 sm:max-w-sm w-full`
4. Make status filter full width on mobile:
   - Change `w-40` on status SelectTrigger to `w-full sm:w-40`
5. Make department filter full width on mobile:
   - Change `w-40` on department SelectTrigger to `w-full sm:w-40`
6. Make Add Initiative button full width on mobile:
   - Add `w-full sm:w-auto` to the Button inside DialogTrigger
  </action>
  <verify>
Resize browser to mobile width (< 640px):
- Search input spans full width
- Status filter spans full width
- Department filter spans full width
- Add Initiative button spans full width
- All controls stack vertically
  </verify>
  <done>Toolbar stacks vertically on mobile with full-width controls</done>
</task>

<task type="auto">
  <name>Task 2: Priority columns and touch-friendly actions</name>
  <files>src/components/initiatives/initiatives-list.tsx</files>
  <action>
Update table for responsive columns and touch-friendly actions:

1. Add imports at top (DropdownMenu, cn):
```typescript
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu'
import { MoreHorizontal } from 'lucide-react'
import { cn } from '@/lib/utils'
```

2. Hide secondary columns on mobile (Key Result, Department, Status, Owner, End Date):
   - Key Result TableHead: add `className="hidden md:table-cell w-24"`
   - Department TableHead: add `className="hidden md:table-cell w-28"`
   - Status TableHead: add `className="hidden md:table-cell w-28"`
   - Owner TableHead: add `className="hidden md:table-cell w-24"`
   - End Date TableHead: add `className="hidden md:table-cell w-28"`
   - Add `hidden md:table-cell` to corresponding TableCells

3. Keep # column visible (small, important identifier)
   - No changes needed, already has `w-12`

4. Keep Initiative column visible (primary info)
   - No changes needed to header

5. Update Initiative cell to show status badge inline on mobile:
   - After the title `<p>`, add:
```typescript
<Badge
  variant="secondary"
  className={cn(getStatusColor(initiative.status), "md:hidden mt-1")}
>
  {formatStatus(initiative.status)}
</Badge>
```

6. Update Actions column:
   - Change TableHead from `className="w-20"` to `className="w-16"`
   - Remove the sr-only span and just add:
```typescript
<TableHead className="w-16">
  <span className="sr-only">Actions</span>
</TableHead>
```

7. Replace the existing action Button with a DropdownMenu:
```typescript
<TableCell>
  <DropdownMenu>
    <DropdownMenuTrigger asChild>
      <Button
        variant="ghost"
        size="icon"
        className={cn(
          "h-8 w-8",
          "md:opacity-0 md:group-hover:opacity-100",
          "focus:opacity-100 transition-opacity"
        )}
      >
        <MoreHorizontal className="h-4 w-4" />
        <span className="sr-only">Actions</span>
      </Button>
    </DropdownMenuTrigger>
    <DropdownMenuContent align="end">
      <DropdownMenuItem asChild>
        <Link href={`/initiatives/${initiative.id}`}>
          <Eye className="h-4 w-4 mr-2" />
          View Details
        </Link>
      </DropdownMenuItem>
    </DropdownMenuContent>
  </DropdownMenu>
</TableCell>
```

8. Add `group` class to TableRow for hover detection:
   - Change `<TableRow key={initiative.id}>` to `<TableRow key={initiative.id} className="group hover:bg-gray-50">`

9. Update empty state colSpan from 8 to 3 for mobile consistency (or keep at 8 for desktop)
   - Actually, keep at 8 since we're hiding columns, not removing them
  </action>
  <verify>
Test at mobile width (< 768px):
- Only #, Initiative, and Actions columns visible
- Status badge shows inline under initiative title on mobile
- Action button (three dots) always visible on mobile
Test at tablet+ width (>= 768px):
- All 8 columns visible
- Status badge shows in separate column
- Action button appears on row hover only
Functional test:
- Tapping action button opens dropdown with "View Details"
- Clicking "View Details" navigates to initiative detail page
  </verify>
  <done>Initiatives table shows priority columns on mobile with always-visible action button</done>
</task>

<task type="auto">
  <name>Task 3: Responsive summary text</name>
  <files>src/components/initiatives/initiatives-list.tsx</files>
  <action>
Make the summary text more compact on mobile:

Change the summary div from:
```typescript
<div className="text-sm text-gray-500">
  Showing {filteredInitiatives.length} of {initiatives.length} initiatives
</div>
```

To:
```typescript
<div className="text-sm text-gray-500">
  <span className="hidden sm:inline">Showing </span>
  {filteredInitiatives.length} of {initiatives.length}
  <span className="hidden sm:inline"> initiatives</span>
</div>
```
  </action>
  <verify>
At mobile width: Summary shows "5 of 10" (shorter format)
At tablet+ width: Summary shows "Showing 5 of 10 initiatives" (full format)
  </verify>
  <done>Summary text is compact on mobile</done>
</task>

</tasks>

<verification>
Manual testing checklist:
1. Mobile (< 640px):
   - [ ] Toolbar controls stack vertically and span full width
   - [ ] Only #, Initiative, Actions columns visible
   - [ ] Status badge shows inline under initiative title
   - [ ] Action button always visible
   - [ ] Tapping action button opens dropdown
   - [ ] Summary shows compact format
2. Tablet/Desktop (>= 768px):
   - [ ] All 8 columns visible
   - [ ] Status badge in separate column
   - [ ] Action button appears on hover only
   - [ ] Summary shows full format

Run dev server: `npm run dev`
Test URL: http://localhost:3000/initiatives?view=list
</verification>

<success_criteria>
- TBL-01: Initiatives table shows #, Initiative, Actions on mobile (priority columns)
- TBL-02: Key Result, Department, Status, Owner, End Date hidden on mobile, visible on tablet+
- TBL-03: Action button always visible on mobile, accessible via tap
- TBL-04: Search, status filter, department filter work on mobile (stack vertically)
</success_criteria>

<output>
After completion, create `.planning/phases/18-tables-responsive/18-02-SUMMARY.md`
</output>
