---
phase: 18-tables-responsive
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/companies/company-list.tsx
autonomous: true

must_haves:
  truths:
    - "User on mobile sees Name column with industry inline below, and Actions column"
    - "User on mobile can tap visible action button to access row actions"
    - "User on mobile can use search and filter controls without overflow"
    - "User on tablet+ sees all columns (Name, Industry, Contacts, Added)"
  artifacts:
    - path: "src/components/companies/company-list.tsx"
      provides: "Responsive companies table with priority columns"
      contains: "hidden md:table-cell"
  key_links:
    - from: "TableRow"
      to: "group class"
      via: "hover detection for actions"
      pattern: "group.*hover"
    - from: "Action button"
      to: "opacity classes"
      via: "mobile-visible, desktop-hover pattern"
      pattern: "md:opacity-0.*md:group-hover:opacity-100"
---

<objective>
Make Companies table work effectively on mobile devices with priority columns and touch-friendly actions.

Purpose: Users can browse and manage companies on any device without horizontal scrolling.
Output: Responsive company-list.tsx with mobile column visibility and always-visible action button.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/18-tables-responsive/18-RESEARCH.md

@src/components/companies/company-list.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Responsive toolbar for companies</name>
  <files>src/components/companies/company-list.tsx</files>
  <action>
Update the toolbar section to stack properly on mobile:
1. The outer flex container already has `flex-col gap-4 sm:flex-row` - good
2. Make the inner filter group stack on mobile:
   - Change `flex flex-1 items-center gap-4` to `flex flex-col sm:flex-row flex-1 items-stretch sm:items-center gap-3 sm:gap-4`
3. Make search input full width on mobile:
   - Change `relative flex-1 max-w-sm` to `relative flex-1 sm:max-w-sm w-full`
4. Make industry filter full width on mobile:
   - Change `w-44` on SelectTrigger to `w-full sm:w-44`
5. Make Add Company button full width on mobile:
   - Add `w-full sm:w-auto` to the Button inside DialogTrigger
  </action>
  <verify>
Resize browser to mobile width (< 640px):
- Search input spans full width
- Industry filter spans full width
- Add Company button spans full width
- All controls stack vertically with consistent spacing
  </verify>
  <done>Toolbar stacks vertically on mobile with full-width controls</done>
</task>

<task type="auto">
  <name>Task 2: Priority columns and touch-friendly actions</name>
  <files>src/components/companies/company-list.tsx</files>
  <action>
Update table for responsive columns and touch-friendly actions:

1. Add DropdownMenu imports at top:
```typescript
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu'
import { MoreHorizontal, Eye } from 'lucide-react'
import { cn } from '@/lib/utils'
```

2. Hide secondary columns on mobile (Industry, Contacts, Added):
   - Change Industry TableHead: add `className="hidden md:table-cell w-32"`
   - Change Contacts TableHead: add `className="hidden md:table-cell w-24 text-center"`
   - Change Added TableHead: add `className="hidden md:table-cell w-32"`
   - Change corresponding TableCells to include `hidden md:table-cell`

3. Add Actions column header after Added:
```typescript
<TableHead className="w-16">
  <span className="sr-only">Actions</span>
</TableHead>
```

4. Update the Name cell to show industry inline on mobile:
   - Below the company name `<p>`, add:
```typescript
{company.industry && (
  <p className="text-sm text-gray-500 md:hidden truncate">
    {company.industry}
  </p>
)}
```

5. Add Actions TableCell at end of each row with dropdown:
```typescript
<TableCell>
  <DropdownMenu>
    <DropdownMenuTrigger asChild>
      <Button
        variant="ghost"
        size="icon"
        className={cn(
          "h-8 w-8",
          "md:opacity-0 md:group-hover:opacity-100",
          "focus:opacity-100 transition-opacity"
        )}
        onClick={(e) => e.stopPropagation()}
      >
        <MoreHorizontal className="h-4 w-4" />
        <span className="sr-only">Actions</span>
      </Button>
    </DropdownMenuTrigger>
    <DropdownMenuContent align="end">
      <DropdownMenuItem onClick={() => handleRowClick(company.id)}>
        <Eye className="h-4 w-4 mr-2" />
        View Details
      </DropdownMenuItem>
    </DropdownMenuContent>
  </DropdownMenu>
</TableCell>
```

6. Add `group` class to TableRow for hover detection:
   - Change `className="cursor-pointer hover:bg-gray-50"` to `className="group cursor-pointer hover:bg-gray-50"`

7. Update empty state colSpan from 4 to 5 (for new Actions column)
  </action>
  <verify>
Test at mobile width (< 768px):
- Only Name column and Actions column visible
- Industry shows inline under company name on mobile
- Action button (three dots) always visible on mobile
Test at tablet+ width (>= 768px):
- All columns visible (Name, Industry, Contacts, Added, Actions)
- Action button appears on row hover only
Functional test:
- Tapping action button opens dropdown with "View Details"
- Clicking "View Details" opens company detail modal
  </verify>
  <done>Companies table shows priority columns on mobile with always-visible action button</done>
</task>

<task type="auto">
  <name>Task 3: Responsive summary text</name>
  <files>src/components/companies/company-list.tsx</files>
  <action>
Make the summary text more compact on mobile:

Change the summary div from:
```typescript
<div className="text-sm text-gray-500">
  Showing {filteredCompanies.length} of {companies.length} companies
</div>
```

To:
```typescript
<div className="text-sm text-gray-500">
  <span className="hidden sm:inline">Showing </span>
  {filteredCompanies.length} of {companies.length}
  <span className="hidden sm:inline"> companies</span>
</div>
```

This shows "5 of 10" on mobile and "Showing 5 of 10 companies" on tablet+.
  </action>
  <verify>
At mobile width: Summary shows "5 of 10" (shorter format)
At tablet+ width: Summary shows "Showing 5 of 10 companies" (full format)
  </verify>
  <done>Summary text is compact on mobile</done>
</task>

</tasks>

<verification>
Manual testing checklist:
1. Mobile (< 640px):
   - [ ] Toolbar controls stack vertically and span full width
   - [ ] Only Name and Actions columns visible
   - [ ] Industry shows inline under company name
   - [ ] Action button always visible
   - [ ] Tapping action button opens dropdown
   - [ ] Summary shows compact format
2. Tablet/Desktop (>= 768px):
   - [ ] All columns visible (Name, Industry, Contacts, Added, Actions)
   - [ ] Action button appears on hover only
   - [ ] Clicking row opens company detail modal
   - [ ] Summary shows full format

Run dev server: `npm run dev`
Test URL: http://localhost:3000/crm
</verification>

<success_criteria>
- TBL-01: Companies table shows Name + Actions on mobile (priority columns)
- TBL-02: Industry, Contacts, Added columns hidden on mobile, visible on tablet+
- TBL-03: Action button always visible on mobile, accessible via tap
- TBL-04: Search and filter controls work on mobile (stack vertically)
</success_criteria>

<output>
After completion, create `.planning/phases/18-tables-responsive/18-01-SUMMARY.md`
</output>
