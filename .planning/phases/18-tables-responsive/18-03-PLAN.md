---
phase: 18-tables-responsive
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/admin/user-list.tsx
autonomous: true

must_haves:
  truths:
    - "User on mobile sees User column (avatar + name with email inline) and Actions column"
    - "User on mobile can tap visible action button to delete user"
    - "User on mobile can change user role via the role dropdown"
    - "User on tablet+ sees all 5 columns (User, Email, Role, Joined, Actions)"
  artifacts:
    - path: "src/components/admin/user-list.tsx"
      provides: "Responsive admin user table with priority columns"
      contains: "hidden md:table-cell"
  key_links:
    - from: "TableRow"
      to: "group class"
      via: "hover detection for actions"
      pattern: "group.*hover"
    - from: "Delete button"
      to: "opacity classes"
      via: "mobile-visible, desktop-hover pattern"
      pattern: "md:opacity-0.*md:group-hover:opacity-100"
---

<objective>
Make Admin user list table work effectively on mobile devices with priority columns and touch-friendly actions.

Purpose: Admin users can manage team members on any device without horizontal scrolling.
Output: Responsive user-list.tsx with mobile column visibility and accessible role/delete actions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/18-tables-responsive/18-RESEARCH.md

@src/components/admin/user-list.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Priority columns for user table</name>
  <files>src/components/admin/user-list.tsx</files>
  <action>
Update table for responsive columns:

1. Add cn import at top:
```typescript
import { cn } from "@/lib/utils"
```

2. Hide Email column on mobile:
   - Change Email TableHead to: `<TableHead className="hidden md:table-cell">Email</TableHead>`
   - Change Email TableCell to: `<TableCell className="hidden md:table-cell text-muted-foreground">`

3. Hide Joined column on mobile:
   - Change Joined TableHead to: `<TableHead className="hidden md:table-cell">Joined</TableHead>`
   - Change Joined TableCell to: `<TableCell className="hidden md:table-cell text-muted-foreground text-sm">`

4. Keep User column visible (primary identifier)
   - Update User cell to show email inline on mobile:
   - After the name `<p>` with badge, add:
```typescript
{user.email && (
  <p className="text-sm text-muted-foreground md:hidden truncate">
    {user.email}
  </p>
)}
```

5. Keep Role column visible (important for admin function)
   - No changes needed

6. Keep Actions column visible
   - No changes needed to header
  </action>
  <verify>
Test at mobile width (< 768px):
- Only User, Role, Actions columns visible
- Email shows inline under user name on mobile
Test at tablet+ width (>= 768px):
- All 5 columns visible (User, Email, Role, Joined, Actions)
  </verify>
  <done>User table shows priority columns on mobile</done>
</task>

<task type="auto">
  <name>Task 2: Touch-friendly action button</name>
  <files>src/components/admin/user-list.tsx</files>
  <action>
Make the delete button always visible on mobile:

1. Add `group` class to TableRow:
   - Change `<TableRow key={user.id}>` to `<TableRow key={user.id} className="group hover:bg-muted/50">`

2. Update the DeleteUserButton wrapper in the Actions TableCell:
   - The DeleteUserButton already renders a Button, we need to add visibility classes to it
   - Wrap the DeleteUserButton in a div with visibility classes:
```typescript
<TableCell>
  <div
    className={cn(
      "md:opacity-0 md:group-hover:opacity-100",
      "focus-within:opacity-100 transition-opacity"
    )}
  >
    <DeleteUserButton
      userId={user.id}
      userEmail={user.email ?? "this user"}
      disabled={isCurrentUser}
    />
  </div>
</TableCell>
```

3. Alternatively, if DeleteUserButton doesn't support className pass-through, the wrapper approach is cleaner. Check DeleteUserButton implementation - if it accepts className, add directly:
```typescript
<DeleteUserButton
  userId={user.id}
  userEmail={user.email ?? "this user"}
  disabled={isCurrentUser}
  className={cn(
    "md:opacity-0 md:group-hover:opacity-100",
    "focus:opacity-100 transition-opacity"
  )}
/>
```

Use the wrapper div approach as it's more reliable without modifying DeleteUserButton.
  </action>
  <verify>
Test at mobile width (< 768px):
- Delete button always visible (full opacity)
Test at tablet+ width (>= 768px):
- Delete button appears on row hover only
- Delete button has full opacity when focused (keyboard navigation)
Functional test:
- Delete button works on both mobile and desktop
- "You" badge still shows for current user
- Delete button is disabled for current user
  </verify>
  <done>Delete button is always visible on mobile, hover-only on desktop</done>
</task>

<task type="auto">
  <name>Task 3: Responsive summary text</name>
  <files>src/components/admin/user-list.tsx</files>
  <action>
Make the summary text more compact on mobile:

Change the summary div (inside CardContent or below Table) from:
```typescript
<div className="px-4 py-3 border-t text-sm text-muted-foreground">
  {users.length} user{users.length !== 1 ? "s" : ""} total
</div>
```

To a more compact mobile format:
```typescript
<div className="px-4 py-3 border-t text-sm text-muted-foreground">
  <span className="sm:hidden">{users.length}</span>
  <span className="hidden sm:inline">{users.length} user{users.length !== 1 ? "s" : ""} total</span>
</div>
```

This shows just the number on mobile ("5") and full text on tablet+ ("5 users total").
  </action>
  <verify>
At mobile width: Summary shows just the count (e.g., "5")
At tablet+ width: Summary shows full text (e.g., "5 users total")
  </verify>
  <done>Summary text is compact on mobile</done>
</task>

</tasks>

<verification>
Manual testing checklist:
1. Mobile (< 640px):
   - [ ] Only User, Role, Actions columns visible
   - [ ] Email shows inline under user name
   - [ ] Delete button always visible
   - [ ] Role dropdown works
   - [ ] Summary shows just count
2. Tablet/Desktop (>= 768px):
   - [ ] All 5 columns visible (User, Email, Role, Joined, Actions)
   - [ ] Delete button appears on hover only
   - [ ] Summary shows full text
3. Functional:
   - [ ] Can change user role on mobile
   - [ ] Can delete user on mobile
   - [ ] Current user badge shows correctly
   - [ ] Cannot delete self (button disabled)

Run dev server: `npm run dev`
Test URL: http://localhost:3000/admin/users
(Requires admin role)
</verification>

<success_criteria>
- TBL-01: User table shows User, Role, Actions on mobile (priority columns)
- TBL-02: Email, Joined columns hidden on mobile, visible on tablet+
- TBL-03: Delete button always visible on mobile, role dropdown accessible
- TBL-05: Admin users table follows same responsive pattern as other tables
</success_criteria>

<output>
After completion, create `.planning/phases/18-tables-responsive/18-03-SUMMARY.md`
</output>
