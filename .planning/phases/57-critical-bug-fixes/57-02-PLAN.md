# Plan 57-02: Fix Unscrollable Modals

## Frontmatter
- **Phase**: 57 - Critical Bug Fixes
- **Wave**: 1
- **Depends on**: Nothing
- **Files modified**:
  - `src/components/ui/dialog.tsx` (MODIFY)
- **Autonomous**: yes
- **Requirement**: BUG-02

## Goal
All modals with content taller than the viewport allow vertical scrolling to reach all content.

## Context
- `DialogContent` in `dialog.tsx` uses `grid` layout as the base which conflicts with `flex flex-col` overrides from consumers like `detail-view.tsx`
- The `detail-view.tsx` dialog mode applies `md:max-w-[650px] p-0 flex flex-col` to override the base, but the base still has `grid` and `p-6`
- `ScrollArea` inside `detail-view.tsx` uses `flex-1 min-h-0` which only works in a flex-col context
- The `overflow-y-auto` on the DialogContent container provides a fallback for scrolling

## Tasks

<task id="1">
**Fix DialogContent base layout for scroll support**

In `src/components/ui/dialog.tsx`, update `DialogContent` base classes:

1. Keep `overflow-y-auto` on the content container as a universal fallback
2. Ensure the mobile full-height mode has proper height containment
3. The key change: ensure the content container properly constrains its children so overflow scrolling works

Current problematic classes on DialogContent:
```
"fixed z-50 grid w-full gap-4 border bg-background p-6 shadow-lg duration-200 overflow-y-auto"
```

The `grid` layout combined with child flex overrides can cause scroll issues. Since consumers like `detail-view.tsx` need `flex flex-col`, ensure the dialog supports both use cases:

- Keep the base as-is for simple dialogs (AlertDialog, etc. use grid layout)
- The `overflow-y-auto` on the base already allows scrolling
- The real issue is that `max-h-[85vh]` may not propagate properly to constrain the grid children

Fix: Add `max-h-[85vh]` to desktop styling. The mobile `h-[calc(100vh-2rem)]` already constrains height.

Verify the current desktop classes include: `md:max-h-[85vh]` — they already do.

The actual fix needed: the `overflow-y-auto` scrolling is on the outer container but when `p-0 flex flex-col` is applied by detail-view, the inner ScrollArea needs the container to have explicit height boundaries. Ensure the classes work correctly:

Update the base classes from:
```
"fixed z-50 grid w-full gap-4 border bg-background p-6 shadow-lg duration-200 overflow-y-auto",
```
to:
```
"fixed z-50 w-full gap-4 border bg-background p-6 shadow-lg duration-200 overflow-y-auto",
```

Remove `grid` from the base. Simple dialogs that need grid can add it. The `gap-4` still works in flex contexts. This allows `flex flex-col` from consumers to take over correctly.

Additionally, for the mobile full-screen mode, add `flex flex-col` to ensure scrolling works on mobile too:
- Mobile classes: `"inset-x-0 bottom-0 h-[calc(100vh-2rem)] rounded-t-2xl flex flex-col"`
</task>

## Verification
1. Open any detail view (project, company, deal, supplier, initiative) in dialog mode — content scrolls when exceeding viewport
2. Open on mobile viewport — bottom sheet mode also scrolls
3. Open AlertDialog (delete confirmation) — still renders correctly (compact, no scroll needed)
4. Open ProjectFormModal — form content scrolls if it exceeds viewport
5. No layout regressions on any modal/dialog across the app

## must_haves
- [ ] Dialog content scrolls vertically when content exceeds viewport height on desktop
- [ ] Dialog content scrolls vertically on mobile (bottom sheet mode)
- [ ] AlertDialog still renders correctly without layout issues
- [ ] No visual regressions on existing modals
