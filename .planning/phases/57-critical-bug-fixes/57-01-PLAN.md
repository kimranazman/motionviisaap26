# Plan 57-01: Fix Project Detail Navigation Error

## Frontmatter
- **Phase**: 57 - Critical Bug Fixes
- **Wave**: 1
- **Depends on**: Nothing
- **Files modified**:
  - `src/app/(dashboard)/projects/[id]/page.tsx` (CREATE)
  - `src/components/projects/project-list.tsx` (MODIFY)
- **Autonomous**: yes
- **Requirement**: BUG-01

## Goal
Clicking a project card on `/projects` navigates to a detail view without console errors or blank pages, and the expand button on the detail sheet opens a full-page project detail.

## Context
- `ProjectDetailSheet` has `expandHref={/projects/${project.id}}` but no page exists at that route
- `project-list.tsx` line 50 uses `useState(() => { ... })` as an effect (anti-pattern)
- The card click itself opens a `ProjectDetailSheet` via `handleCardClick` which works, but the URL-based open and expand link are broken

## Tasks

<task id="1">
**Create `/projects/[id]` full-page route**

Create `src/app/(dashboard)/projects/[id]/page.tsx` that:
1. Takes `params.id` as a dynamic route parameter
2. Fetches the project from Prisma with same includes as the list page (company, contact, sourceDeal, sourcePotential, initiative)
3. Also fetches costs, deliverables, tasks, and documents
4. If project not found, call `notFound()`
5. Renders a full-page layout with Header showing the project title
6. Below the header, render the project detail content in a scrollable area
7. Include a "Back to Projects" link
8. Follow the same pattern as `src/app/(dashboard)/initiatives/[id]/page.tsx` if it exists

Reference the page structure from `src/app/(dashboard)/projects/page.tsx` for the layout pattern.
</task>

<task id="2">
**Fix useState anti-pattern in project-list.tsx**

In `src/components/projects/project-list.tsx`, change line 50:

FROM:
```tsx
useState(() => {
  if (openProjectId) {
    const projectToOpen = initialData.find(p => p.id === openProjectId)
    if (projectToOpen) {
      setSelectedProject(projectToOpen)
      setIsDetailOpen(true)
    }
  }
})
```

TO: Use `useEffect` instead:
```tsx
useEffect(() => {
  if (openProjectId) {
    const projectToOpen = initialData.find(p => p.id === openProjectId)
    if (projectToOpen) {
      setSelectedProject(projectToOpen)
      setIsDetailOpen(true)
    }
  }
}, []) // Run once on mount
```

Add `useEffect` to the React imports if not already present.
</task>

## Verification
1. Navigate to `/projects` — page loads without errors
2. Click a project card — detail sheet opens showing project information
3. Click the expand button on the detail sheet — navigates to `/projects/{id}` full page view
4. Navigate directly to `/projects/{id}` — full page project detail loads
5. Navigate to `/projects/{id}` with a non-existent ID — shows 404 page
6. No console errors on any of these navigation paths

## must_haves
- [ ] `/projects/[id]` page route exists and renders project details
- [ ] Project card click opens detail sheet without errors
- [ ] Expand button navigates to full-page project detail
- [ ] Non-existent project ID shows 404
- [ ] No `useState` anti-pattern for side effects
